CREATE TABLE t_Aneta_Siobos_project_SQL_secondary_final
SELECT YEAR, ROUND(GDP,0)
FROM economies e 
WHERE COUNTRY = 'Czech republic'
AND YEAR BETWEEN 2006 AND 2018
ORDER BY YEAR ASC;


Nefunguje, vycházejí špatné hodnoty:
CREATE TABLE czechia_price_and_payroll_selection
WITH czechia_price_selection_YOY_change AS (
    SELECT *,
           LEAD(avg_value, 1) OVER (PARTITION BY category_code ORDER BY YEAR) lead_function
    FROM czechia_price_selection
)
, czechia_payroll_selection_YOY_change AS (
    SELECT *,
           LEAD(avg_value, 1) OVER (PARTITION BY category_code ORDER BY YEAR) lead_function
    FROM czechia_payroll_selection
)
SELECT 
    p.YEAR AS price_YEAR,
    p.avg_value AS price_avg_value,
    pr.YEAR AS payroll_YEAR,
    pr.avg_value AS payroll_avg_value,
    ROUND((p.lead_function - p.avg_value) / p.avg_value * 100, 2) AS YOY_change_price,
    pr.lead_function AS lead_function_payroll,
    ROUND((pr.lead_function - pr.avg_value) / pr.avg_value * 100, 2) AS YOY_change_payroll
FROM czechia_price_selection_YOY_change p
INNER JOIN czechia_payroll_selection_YOY_change pr ON p.year = pr.year
GROUP BY payroll_YEAR;
