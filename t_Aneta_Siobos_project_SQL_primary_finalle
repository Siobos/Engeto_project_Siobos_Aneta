CZECHIA_PAYROLL

SELECT 
	industry_branch_code, payroll_year, 
	AVG(value) AS avg_value
FROM czechia_payroll cp 
WHERE value_type_code = '5958' AND industry_branch_code IS NOT NULL
GROUP BY industry_branch_code, payroll_year;


SELECT 
	industry_branch_code, payroll_year, cpib.name,
	ROUND(AVG(value),2) AS avg_value
FROM czechia_payroll cp 
	LEFT JOIN czechia_payroll_industry_branch cpib 
	ON cp.industry_branch_code = cpib.code	
WHERE value_type_code = '5958' AND industry_branch_code IS NOT NULL
GROUP BY industry_branch_code, payroll_year;

SELECT 
	industry_branch_code, payroll_year, cpib.name, cpu.name,
	ROUND(AVG(value),2) AS avg_value
FROM czechia_payroll cp 
	LEFT JOIN czechia_payroll_industry_branch cpib 
	ON cp.industry_branch_code = cpib.code	
	LEFT JOIN czechia_payroll_unit cpu
	ON cp.unit_code = cpu.code	
WHERE value_type_code = '5958' AND industry_branch_code IS NOT NULL
GROUP BY industry_branch_code, payroll_year;

CZECHIA_PRICE
Průměrné hodnoty ale neodpovídají:
SELECT 
YEAR(date_from) AS YEAR,
AVG(value) AS avg_value,
category_code,
cpc.name, cpc.price_value, cpc.price_unit
FROM czechia_price cp
LEFT JOIN czechia_price_category cpc 
	ON cp.category_code = cpc.code
GROUP BY year(date_from);
